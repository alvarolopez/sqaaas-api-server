openapi: 3.0.0
info:
  description: API for the Software and Service Quality Assurance as a Service (SQAaaS)
    component.
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  title: SQAaaS API
  version: 0.1.0
servers:
- description: Optional server description, e.g. Main (production) server
  url: http://api.sqaaas.eosc-synergy.eu/v1
- description: Optional server description, e.g. Internal staging server for testing
  url: http://staging-api.sqaaas.eosc-synergy.eu
paths:
  /pipeline:
    get:
      description: |
        Returns the list of IDs for the defined pipelines.
      operationId: get_pipelines
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Pipeline'
                type: array
          description: Successful operation
      summary: Gets pipeline IDs.
      x-openapi-router-controller: openapi_server.controllers.default_controller
    post:
      description: |
        Provides a ready-to-use Jenkins pipeline based on the v2 series of jenkins-pipeline-library.
      operationId: add_pipeline
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Pipeline'
        required: true
        x-body-name: body
      responses:
        "201":
          description: Created
      summary: Creates a pipeline.
      x-openapi-router-controller: openapi_server.controllers.default_controller
      x-codegen-request-body-name: body
  /pipeline/{pipeline_id}:
    get:
      operationId: get_pipeline_by_id
      parameters:
      - description: ID of the pipeline to get
        explode: false
        in: path
        name: pipeline_id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Pipeline'
          description: Successful operation
        "400":
          description: Invalid ID supplied
        "404":
          description: Pipeline not found
      summary: Find pipeline by ID
      x-openapi-router-controller: openapi_server.controllers.default_controller
components:
  schemas:
    Repository:
      properties:
        repo:
          format: uri
          type: string
        branch:
          type: string
      type: object
    CriterionWithRepo:
      example:
        criterion: qc_style
        repos:
        - ""
        - ""
      properties:
        criterion:
          enum:
          - qc_style
          - qc_unit
          - qc_functional
          - qc_security
          - qc_doc
          type: string
        repos:
          items:
            allOf:
            - $ref: '#/components/schemas/Repository'
            - properties:
                container:
                  type: string
                build_tool:
                  enum:
                  - Tox
                  - Command
                  type: string
              required:
              - container
              type: object
          type: array
      required:
      - criterion
      - repos
      type: object
    Pipeline:
      example:
        sqa_criteria:
        - criterion: qc_style
          repos:
          - ""
          - ""
        - criterion: qc_style
          repos:
          - ""
          - ""
      properties:
        sqa_criteria:
          items:
            $ref: '#/components/schemas/CriterionWithRepo'
          type: array
      type: object
